<html>
	<head>
		<link rel="stylesheet" href="css/main.css">
	</head>
	<body>
		<header>
			<nav>
				<ul>
					<li id="blah"><a href="#1">menu 1</a></li>
					<li><a href="#2">menu 2</a></li>
					<li><a href="#3">menu 3</a></li>
					<li><a href="#4">menu 4</a></li>
					<li><a href="#5">menu 5</a></li>
				</ul>
			</nav>
		</header>
		<script type="text/javascript" src="http://127.0.0.1:4000/socket.io/socket.io.js"></script>
		<script src="client/Browser.js"></script>
		<script src="client/Replayer.js"></script>
		<script>
			var socket = io.connect('http://sol.local:4000');

			// when connection to socket is established
			socket.on('connect', function(){

				// set up event to recieve tattle collection
				socket.on('returnCollections', function(data){

					var sel = document.createElement('select');
					sel.name = 'tracks';
					var opt = document.createElement('option');
					var clone;

					for(var i = 0; i < data.length; i += 1){

						clone = opt.cloneNode();
						clone.innerHTML = data[i]._id;
						clone.value = data[i]._id;

						sel.appendChild(clone);
					};

					document.getElementsByTagName('body')[0].appendChild(sel);

					sel.addEventListener('change', function(){
						socket.emit('request_details', this.value);
					});

				});


				socket.on('return_details', function(data){

					REPLAYER.replay(data.mousePath);
				});

				socket.emit('setBrowser', {
					os: BROWSER.getOS(),
					browser: BROWSER.getBrowser(),
					version: BROWSER.getVersion(),
					size: BROWSER.getSize()
				})

				// make call to get tattle collection
				socket.emit('getCollections');
			});
/*
			document.addEventListener('mousemove', function(e){

				socket.emit('mouseMv', {x: e.clientX, y: e.clientY});
			});

			document.addEventListener('click', function(e){

				socket.emit('getDetails', {x: e.clientX, y: e.clientY, clicked: true});
			});
*/
			socket.on('returnDetails', function(data){

				REPLAYER.replay(data.mousePath);
			});
		</script>
	</body>
</html>